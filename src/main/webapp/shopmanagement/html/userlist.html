<!DOCTYPE html>
<html>

	<head>

		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="shortcut icon" href="../favicon.ico">
		<link href="../common/font-awesome-4.7.0/css/font-awesome.css" rel="stylesheet">
		<link href="../css/style.min.css?v=4.0.0" rel="stylesheet">
		<link href="../css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
		<link href="../common/layui/css/layui.css" rel="stylesheet" />
	</head>

	<body class="gray-bg">
		<div class="wrapper wrapper-content animated fadeInRight">
			<div class="row">
				<div class="col-sm-12">
					<div class="ibox float-e-margins">
						<div class="ibox-title">
							<h5>用户列表</h5>
							<div class="ibox-tools">
								<a class="collapse-link">
									<i class="fa fa-chevron-up"></i>
								</a>
								<a class="dropdown-toggle" data-toggle="dropdown">
									<i class="fa fa-wrench"></i>
								</a>

								<a class="close-link">
									<i class="fa fa-times"></i>
								</a>
							</div>
						</div>
						<div class="ibox-content">
							<div class="row">
								<div class="col-sm-3">
									<div class="input-group">

									</div>
								</div>
							</div>
							<div class="layui-btn-group demoTable">
								<button class="layui-btn" data-type="getCheckData">获取选中行数据</button>
								<button class="layui-btn" data-type="getCheckLength">获取选中数目</button>
								<button class="layui-btn" data-type="isAll">验证是否全选</button>
								<button class="layui-btn" data-type="addUser">添加用户方法1</button>
								<button class="layui-btn" data-type="addUser1">添加用户方法2</button>
							</div>
							<div class="table-responsive">
								<table class="layui-table" lay-data="{width: 900, height:332, url:'userlist.json', page:true, id:'idTest'}" lay-filter="demo">
									<thead>
										<tr>
											<th lay-data="{checkbox:true, fixed: true}"></th>
											<th lay-data="{field:'id', width:80, sort: true, fixed: true}">ID</th>
											<th lay-data="{field:'username', width:80}">用户名</th>
											<th lay-data="{field:'sex', width:80, sort: true}">性别</th>
											<th lay-data="{field:'city', width:80}">城市</th>
											<th lay-data="{field:'sign', width:177}">签名</th>
											<th lay-data="{field:'experience', width:80, sort: true}">积分</th>
											<th lay-data="{field:'classify', width:80}">职业</th>
											<th lay-data="{field:'wealth', width:135, sort: true}">财富</th>
											<th lay-data="{fixed: 'right', width:180, align:'center', toolbar: '#barDemo'}">操作</th>
										</tr>
									</thead>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script type="text/html" id="barDemo">
			<a class="layui-btn layui-btn-primary layui-btn-mini" lay-event="detail"><i class="fa fa-eye" aria-hidden="true" title="查看"></i></a>
			<a class="layui-btn layui-btn-mini" lay-event="edit"><i class="fa fa-edit" aria-hidden="true" title="编辑"></i></a>
			<a class="layui-btn layui-btn-danger layui-btn-mini" lay-event="del"><i class="fa fa-trash" aria-hidden="true" title="删除"></i></a>
		</script>
		<script src="../common/layui/layui.js" charset="utf-8" type="text/javascript"></script>
		<script src="../js/plugins/sweetalert/sweetalert.min.js"></script>
		<script>
			layui.use('table', function() {
				var table = layui.table;
				
				//监听表格复选框选择
				table.on('checkbox(demo)', function(obj) {
					console.log(obj)
				});
				//监听工具条
				table.on('tool(demo)', function(obj) {
					var data = obj.data;
					if(obj.event === 'detail') {
						layer.msg('ID：' + data.id + ' 的查看操作');
					} else if(obj.event === 'del') {
						//自带的弹窗效果
						/*
						layer.confirm('真的删除行么', function(index) {
							obj.del();
							layer.close(index);
						});
						*/
						
						//强势弹窗效果
						swal({
							title: "您确定要删除'ID：="+data.id+"信息吗",
							text: "删除后将无法恢复，请谨慎操作！",
							type: "warning",
							showCancelButton: true,
							confirmButtonColor: "#DD6B55",
							confirmButtonText: "删除",
							closeOnConfirm: false
						}, function() {
							//通 ajax 加载方法
							swal("删除成功！", "您已经永久删除了这条信息。", "success")
						})
						
					} else if(obj.event === 'edit') {
						layer.alert('编辑行：<br>' + JSON.stringify(data))
					}
				});

				var $ = layui.$,
					active = {
						getCheckData: function() { //获取选中数据
							var checkStatus = table.checkStatus('idTest'),
								data = checkStatus.data;
							layer.alert(JSON.stringify(data));
						},
						getCheckLength: function() { //获取选中数目
							var checkStatus = table.checkStatus('idTest'),
								data = checkStatus.data;
							layer.msg('选中了：' + data.length + ' 个');
						},
						isAll: function() { //验证是否全选
							var checkStatus = table.checkStatus('idTest');
							layer.msg(checkStatus.isAll ? '全选' : '未全选')
						},
						addUser:function(){
							parent.layer.open({
							    type: 2,
							    title:"添加用户",
							    shadeClose: true,
							    btn:['添加用户','取消'],
					  			shade: 0.8,
					  			maxmin: true,
					  			area: ['80%', '90%'],
							    content: 'adduser.html', //注意，如果str是object，那么需要字符拼接。
							    yes:function(){
							    	layer.msg("添加成功！");
							    	layer.closeAll();
							    },
							    btn1:function(){
							    	layer.close();
							    }
							  });
						},
						addUser1:function(){
                            parent.layer.open({
								type: 2,
							    title:"添加用户",
							    shadeClose: true,
					  			shade: 0.8,
					  			area: ['80%', '90%'],
							    content: 'adduser.html', //注意，如果str是object，那么需要字符拼接。
							});
						}
						
					};

				$('.demoTable .layui-btn').on('click', function() {
					var type = $(this).data('type');
					active[type] ? active[type].call(this) : '';
				});
			});
		</script>

	</body>

</html>